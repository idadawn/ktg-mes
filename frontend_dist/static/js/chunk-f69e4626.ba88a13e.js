(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f69e4626","chunk-2d0b61c3"],{"058d":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},["view"!=t.optType?n("el-row",{staticClass:"mb8",attrs:{gutter:10}},[n("el-col",{attrs:{span:1.5}},[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:md:mditem:add"],expression:"['mes:md:mditem:add']"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:t.handleAdd}},[t._v("新增")])],1),n("el-col",{attrs:{span:1.5}},[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:md:mditem:remove"],expression:"['mes:md:mditem:remove']"}],attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"mini",disabled:t.multiple},on:{click:t.handleDelete}},[t._v("删除")])],1),n("right-toolbar",{attrs:{showSearch:t.showSearch},on:{"update:showSearch":function(e){t.showSearch=e},"update:show-search":function(e){t.showSearch=e},queryTable:t.getList}})],1):t._e(),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.printerconfigList},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),n("el-table-column",{attrs:{label:"打印机编号",align:"center",prop:"printerCode","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["print:printerconfig:query"],expression:"['print:printerconfig:query']"}],attrs:{type:"text"},on:{click:function(n){return t.handleView(e.row)}}},[t._v(t._s(e.row.printerCode))])]}}])}),n("el-table-column",{attrs:{label:"是否默认",align:"center",prop:"defaultFlag"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("dict-tag",{attrs:{options:t.dict.type.sys_yes_no,value:e.row.defaultFlag}})]}}])}),n("el-table-column",{attrs:{label:"打印机类型",align:"center",prop:"printerType"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("dict-tag",{attrs:{options:t.dict.type.mes_printer_type,value:e.row.printerType}})]}}])}),n("el-table-column",{attrs:{label:"打印机名称",align:"center",prop:"printerName"}}),n("el-table-column",{attrs:{label:"品牌",align:"center",prop:"brand"}}),n("el-table-column",{attrs:{label:"型号",align:"center",prop:"printerModel"}}),n("el-table-column",{attrs:{label:"连接类型",align:"center",prop:"connectionType"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("dict-tag",{attrs:{options:t.dict.type.mes_conn_type,value:e.row.connectionType}})]}}])}),n("el-table-column",{attrs:{label:"打印机IP",align:"center",prop:"printerIp"}}),n("el-table-column",{attrs:{label:"打印机端口",align:"center",prop:"printerPort"}}),n("el-table-column",{attrs:{label:"启用状态",align:"center",prop:"enableFlag"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("dict-tag",{attrs:{options:t.dict.type.sys_yes_no,value:e.row.enableFlag}})]}}])}),n("el-table-column",{attrs:{label:"打印机状态",align:"center",prop:"status"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("dict-tag",{attrs:{options:t.dict.type.mes_printer_status,value:e.row.status}})]}}])}),"view"!=t.optType?n("el-table-column",{attrs:{label:"操作",align:"center",width:"200px","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:md:mditem:edit"],expression:"['mes:md:mditem:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(n){return t.handleUpdate(e.row)}}},[t._v("修改")]),n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:md:mditem:remove"],expression:"['mes:md:mditem:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(n){return t.handleDelete(e.row)}}},[t._v("删除")]),"Y"!=e.row.defaultFlag?n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["print:printerconfig:list"],expression:"['print:printerconfig:list']"}],attrs:{size:"mini",type:"text",icon:"el-icon-star-off"},on:{click:function(n){return t.handleDefault(e.row)}}},[t._v("设置为默认")]):t._e()]}}],null,!1,3684476485)}):t._e()],1),n("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.queryParams.pageNum,limit:t.queryParams.pageSize},on:{"update:page":function(e){return t.$set(t.queryParams,"pageNum",e)},"update:limit":function(e){return t.$set(t.queryParams,"pageSize",e)},pagination:t.getList}}),n("el-dialog",{attrs:{title:t.title,visible:t.open,width:"50%","append-to-body":""},on:{"update:visible":function(e){t.open=e}}},[n("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"100px"}},[n("el-row",[n("el-col",{attrs:{span:16}},[n("el-row",[n("el-col",{attrs:{span:16}},[n("el-form-item",{attrs:{label:"打印机编号",prop:"printerCode"}},[n("el-input",{attrs:{placeholder:"请输入打印机编号"},model:{value:t.form.printerCode,callback:function(e){t.$set(t.form,"printerCode",e)},expression:"form.printerCode"}})],1)],1),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{"label-width":"80"}},["view"!=t.optType?n("el-switch",{attrs:{"active-color":"#13ce66","active-text":"自动生成"},on:{change:function(e){return t.handleAutoGenChange(t.autoGenFlag)}},model:{value:t.autoGenFlag,callback:function(e){t.autoGenFlag=e},expression:"autoGenFlag"}}):t._e()],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"打印机名称",prop:"printerName"}},[n("el-select",{attrs:{placeholder:"请选择打印机"},model:{value:t.form.printerName,callback:function(e){t.$set(t.form,"printerName",e)},expression:"form.printerName"}},t._l(t.printerList,(function(t){return n("el-option",{key:t.name,attrs:{label:t.displayName,value:t.name}})})),1)],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"打印机类型",prop:"printerType"}},[n("el-select",{attrs:{placeholder:"请选择打印机类型"},model:{value:t.form.printerType,callback:function(e){t.$set(t.form,"printerType",e)},expression:"form.printerType"}},t._l(t.dict.type.mes_printer_type,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"启用状态",prop:"enableFlag"}},[n("el-radio-group",{model:{value:t.form.enableFlag,callback:function(e){t.$set(t.form,"enableFlag",e)},expression:"form.enableFlag"}},t._l(t.dict.type.sys_yes_no,(function(e){return n("el-radio",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])})),1)],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"品牌",prop:"brand"}},[n("el-input",{attrs:{placeholder:"请输入品牌"},model:{value:t.form.brand,callback:function(e){t.$set(t.form,"brand",e)},expression:"form.brand"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"型号",prop:"printerModel"}},[n("el-input",{attrs:{placeholder:"请输入型号"},model:{value:t.form.printerModel,callback:function(e){t.$set(t.form,"printerModel",e)},expression:"form.printerModel"}})],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"打印机IP",prop:"printerIp"}},[n("el-input",{attrs:{placeholder:"请输入打印机IP"},model:{value:t.form.printerIp,callback:function(e){t.$set(t.form,"printerIp",e)},expression:"form.printerIp"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"打印机端口",prop:"printerPort"}},[n("el-input",{attrs:{placeholder:"请输入打印机端口"},model:{value:t.form.printerPort,callback:function(e){t.$set(t.form,"printerPort",e)},expression:"form.printerPort"}})],1)],1)],1)],1),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"图片URL",prop:"printerUrl"}},[n("ImageUpload",{attrs:{limit:1,value:t.form.printerUrl,fileSize:5},on:{onUploaded:t.handleImgUplaoded,onRemoved:t.handleImgRemoved}})],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"打印机状态"}},[n("el-radio-group",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},t._l(t.dict.type.mes_printer_status,(function(e){return n("el-radio",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])})),1)],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"备注",prop:"remark"}},[n("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["view"!=t.optType?n("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]):t._e(),n("el-button",{on:{click:t.cancel}},[t._v("关 闭")])],1)],1)],1)},r=[],l=(n("d81d"),n("e9f5"),n("7d54"),n("ab43"),n("4fadc"),n("d3b7"),n("ac1f"),n("1276"),n("159b"),n("9d5b")),a=n("8171"),o=n("4863"),s={name:"PrintConfig",dicts:["mes_printer_status","mes_printer_type","mes_conn_type","sys_yes_no"],mixins:[o["a"]],data:function(){return{autoGenFlag:!1,loading:!0,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,printerconfigList:[],printerList:[],title:"",open:!1,queryParams:{pageNum:1,pageSize:10,printerType:null,printerCode:null,printerName:null,brand:null,printerModel:null,connectionType:null,printerUrl:null,printerIp:null,printerPort:null,clientSid:null,clientIp:null,clientPort:null,enableFlag:null,status:null},form:{},rules:{printerCode:[{required:!0,message:"打印机编号不能为空",trigger:"blur"}],printerName:[{required:!0,message:"打印机名称不能为空",trigger:"blur"}],remark:[{max:250,message:"长度必须小于250个字符",trigger:"blur"}]}}},props:{optType:void 0,client:void 0},mounted:function(){this.queryParams.clientId=this.client.clientId,this.getList()},methods:{filterClient:function(){var t=this;if(null!=this.hiprintThis.hiwebSocket.clients&&void 0!=this.hiprintThis.hiwebSocket.clients){var e=Object.entries(this.hiprintThis.hiwebSocket.clients),n=!1;return e.forEach((function(e){var i=e[1].clientUrl.split(e[1].ip+":");e[1].ip==t.client.clientIp&&i[1]==t.client.clientPort&&(t.printerList=e[1].printerList,n=!0)})),!!n||(this.printerList=[],this.$message.warning("客户端未连接"),!1)}return this.printerList=[],this.$message.warning("中转站服务未启动"),!1},handleImgUplaoded:function(t){this.form.printerUrl=t},handleImgRemoved:function(t){this.form.printerUrl=null},handleDownloadClient:function(){var t="http://101.43.244.58:9090/api/v1/buckets/printtool/objects/download?prefix=UHJpbnQuZXhl";this.$download.saveAs(t,"client")},handleDefault:function(t){var e=this;Object(l["f"])(t).then((function(t){200==t.code&&(e.getList(),e.$modal.msgSuccess("设置成功!"))}))},getList:function(){var t=this;this.loading=!0,Object(l["e"])(this.queryParams).then((function(e){t.printerconfigList=e.rows,t.total=e.total,t.loading=!1}))},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={printerId:null,printerCode:null,printerType:null,printerName:null,brand:null,printerModel:null,connectionType:"0",printerUrl:null,printerIp:null,printerPort:null,clientSid:null,clientIp:null,clientPort:null,enableFlag:"Y",status:"READY",remark:null,attr1:null,attr2:null,attr3:null,attr4:null,createBy:null,createTime:null,updateBy:null,updateTime:null},this.resetForm("form")},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange:function(t){this.ids=t.map((function(t){return t.printerId})),this.single=1!==t.length,this.multiple=!t.length},handleAdd:function(){this.filterClient()&&(this.reset(),this.open=!0,this.title="添加打印机配置",this.optType="add")},handleUpdate:function(t){var e=this;if(this.filterClient()){this.reset();var n=t.printerId||this.ids;Object(l["d"])(n).then((function(t){e.form=t.data,e.open=!0,e.title="修改打印机配置",e.optType="edit"}))}},handleView:function(t){var e=this;if(this.filterClient()){this.reset();var n=t.printerId||this.ids;Object(l["d"])(n).then((function(t){e.form=t.data,e.open=!0,e.title="查看打印机配置",e.optType="view"}))}},submitForm:function(){var t=this;this.$refs["form"].validate((function(e){e&&(t.form.clientId=t.client.clientId,null!=t.form.printerId?Object(l["g"])(t.form).then((function(e){t.$modal.msgSuccess("修改成功"),t.open=!1,t.getList()})):Object(l["a"])(t.form).then((function(e){t.$modal.msgSuccess("新增成功"),t.open=!1,t.getList()})))}))},handleDelete:function(t){var e=this,n=t.printerId||this.ids;this.$modal.confirm('是否确认删除打印机配置编号为"'+n+'"的数据项？').then((function(){return Object(l["b"])(n)})).then((function(){e.getList(),e.$modal.msgSuccess("删除成功")})).catch((function(){}))},handleAutoGenChange:function(t){var e=this;t?Object(a["c"])("PRINTER_CODE").then((function(t){e.form.printerCode=t})):this.form.printerCode=null}}},d=s,u=n("2877"),c=Object(u["a"])(d,i,r,!1,null,null,null);e["default"]=c.exports},"1c83":function(t,e,n){"use strict";n.r(e),n.d(e,"aProvider",(function(){return r}));var i=n("0f64"),r=function(t){var e=function(t){t.removePrintElementTypes("defaultModule"),t.addPrintElementTypes("defaultModule",[new i["hiprint"].PrintElementTypeGroup("平台",[{tid:"defaultModule.text",title:"固定文本",data:"固定文本",type:"text",options:{type:"text",testData:"",height:12,fontSize:6.75,width:61.5,textAlign:"left",textContentVerticalAlign:"middle"}},{tid:"defaultModule.image",title:"",data:"",type:"image"},{tid:"defaultModule.longText",title:"长文本",data:"长文本",type:"longText",options:{type:"text",testData:"",height:12,fontSize:6.75,textAlign:"left",textContentVerticalAlign:"middle"}},{tid:"defaultModule.date",title:"",data:"2020-01-01",type:"text",options:{type:"date",field:"date",testData:"2020-01-01",height:16,fontSize:6.75,fontWeight:"700",textAlign:"left",textContentVerticalAlign:"middle"}},{tid:"defaultModule.hline",title:"横线",type:"hline",options:{width:90,height:9}},{tid:"defaultModule.vline",title:"竖线",type:"vline",options:{width:9,height:90}},{tid:"defaultModule.rect",title:"矩形",type:"rect",options:{width:66,height:42}},{tid:"defaultModule.oval",title:"椭圆",type:"oval",options:{width:60,height:60}},{tid:"defaultModule.barcode",title:"条形码",data:"",type:"text",options:{type:"barcode",field:"barcode",testData:"test",height:32,fontSize:12,lineHeight:18,textType:"barcode"}},{tid:"defaultModule.qrcode",title:"二维码",data:"",type:"text",options:{type:"qrcode",field:"barcodeContent",testData:"test",height:40,width:40,fontSize:12,lineHeight:18,hideTitle:!0,textType:"qrcode"}},{tid:"defaultModule.itemCode",title:"物料编码",data:"",type:"text",options:{testData:"IF2022082437",height:12,field:"itemCode",hideTitle:!0,fontSize:6.75,width:61.5,textAlign:"left",textContentVerticalAlign:"middle"}},{tid:"defaultModule.itemName",title:"物料名称",data:"",type:"text",options:{testData:"色粉【黑色】",field:"itemName",hideTitle:!0,height:12,fontSize:6.75,width:61.5,textAlign:"left",textContentVerticalAlign:"middle"}},{tid:"defaultModule.workorderCode",title:"工单编码",data:"",type:"text",options:{testData:"MO202503180014",field:"workorderCode",hideTitle:!0,height:12,fontSize:6.75,width:61.5,textAlign:"left",textContentVerticalAlign:"middle"}},{tid:"defaultModule.workorderName",title:"工单名称",data:"",type:"text",options:{testData:"螺丝刀刀头【10000】PCS",field:"workorderName",hideTitle:!0,height:12,fontSize:6.75,width:61.5,textAlign:"left",textContentVerticalAlign:"middle"}},{tid:"defaultModule.vendorCode",title:"供应商编码",data:"",type:"text",options:{testData:"V00009",field:"vendorCode",hideTitle:!0,height:12,fontSize:6.75,width:61.5,textAlign:"left",textContentVerticalAlign:"middle"}},{tid:"defaultModule.vendorName",title:"供应商名称",data:"",type:"text",options:{testData:"江苏南通塑有为塑料制品有限公司",field:"vendorName",hideTitle:!0,height:12,fontSize:6.75,width:61.5,textAlign:"left",textContentVerticalAlign:"middle"}},{tid:"defaultModule.clientCode",title:"客户编码",data:"",type:"text",options:{testData:"C00184",field:"clientCode",hideTitle:!0,height:12,fontSize:6.75,width:61.5,textAlign:"left",textContentVerticalAlign:"middle"}},{tid:"defaultModule.clientName",title:"客户名称",data:"",type:"text",options:{testData:"比亚迪股份有限公司",field:"clientName",hideTitle:!0,height:12,fontSize:6.75,width:61.5,textAlign:"left",textContentVerticalAlign:"middle"}}])])};return{addElementTypes:e}};e["default"]=r()},4863:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("1c83"),r=n("0f64"),l=(n("fe63"),n("1ca4")),a={data:function(){return{hiprintTemplate:null,hiprintThis:null}},mounted:function(){r["hiprint"].init({providers:[i["default"]],host:l["a"].print_transfer_url,token:l["a"].print_transfer_token}),this.hiprintThis=r["hiprint"],this.hiprintTemplate=new r["hiprint"].PrintTemplate}}},"4fadc":function(t,e,n){"use strict";var i=n("23e7"),r=n("6f53").entries;i({target:"Object",stat:!0},{entries:function(t){return r(t)}})},"6f53":function(t,e,n){"use strict";var i=n("83ab"),r=n("d039"),l=n("e330"),a=n("e163"),o=n("df75"),s=n("fc6a"),d=n("d1e7").f,u=l(d),c=l([].push),p=i&&r((function(){var t=Object.create(null);return t[2]=2,!u(t,2)})),f=function(t){return function(e){var n,r=s(e),l=o(r),d=p&&null===a(r),f=l.length,m=0,h=[];while(f>m)n=l[m++],i&&!(d?n in r:u(r,n))||c(h,t?[n,r[n]]:r[n]);return h}};t.exports={entries:f(!0),values:f(!1)}},8171:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"e",(function(){return l})),n.d(e,"d",(function(){return a})),n.d(e,"a",(function(){return o})),n.d(e,"f",(function(){return s})),n.d(e,"b",(function(){return d}));var i=n("b775");function r(t){return Object(i["a"])({url:"/system/autocode/get/"+t,method:"get"})}function l(t){return Object(i["a"])({url:"/system/autocode/rule/list",method:"get",params:t})}function a(t){return Object(i["a"])({url:"/system/autocode/rule/"+t,method:"get"})}function o(t){return Object(i["a"])({url:"/system/autocode/rule",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/system/autocode/rule",method:"put",data:t})}function d(t){return Object(i["a"])({url:"/system/autocode/rule/"+t,method:"delete"})}},"9d5b":function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return a})),n.d(e,"g",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"f",(function(){return d})),n.d(e,"c",(function(){return u}));var i=n("b775");function r(t){return Object(i["a"])({url:"/print/printerconfig/list",method:"get",params:t})}function l(t){return Object(i["a"])({url:"/print/printerconfig/"+t,method:"get"})}function a(t){return Object(i["a"])({url:"/print/printerconfig",method:"post",data:t})}function o(t){return Object(i["a"])({url:"/print/printerconfig",method:"put",data:t})}function s(t){return Object(i["a"])({url:"/print/printerconfig/"+t,method:"delete"})}function d(t){return Object(i["a"])({url:"/print/printerconfig/editDefaultPrint/",method:"post",data:t})}function u(t){return Object(i["a"])({url:"/print/printerconfig/getDefaultPrint/"+t,method:"get"})}},fe63:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));n("e9f5"),n("7d54"),n("4fadc"),n("b64b"),n("d3b7"),n("159b");var i=n("5c96"),r=n("9d5b");function l(t,e,n,l){if(n)try{n.update(JSON.parse(t));var a=JSON.parse(localStorage.getItem("defaultClient")),o=Object.entries(l.hiwebSocket.clients),s="";o.forEach((function(t){a.clientIp==t[1].ip&&(s=t[0])})),s?Object(r["c"])(a.clientId).then((function(t){200==t.code&&(n.print2(e,{client:s,printer:t.data.printerName,title:"hiprint测试打印"}),i["Message"].success("打印成功"))})).catch((function(t){})):i["Message"].error("客户端未连接,无法直接打印")}catch(d){i["Message"].error("更新失败: ".concat(d))}}}}]);